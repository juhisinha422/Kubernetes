ğ—ğ˜‚ğ—¯ğ—²ğ—¿ğ—»ğ—²ğ˜ğ—²ğ˜€ ğ—¨ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—² ğ—ğ—¼ğ˜‚ğ—¿ğ—»ğ—²ğ˜† ğ—¼ğ—» ğ—˜ğ—ğ—¦ â˜¸ï¸âœ¨

Keeping cluster up to date is crucial since ğ—ğ˜‚ğ—¯ğ—²ğ—¿ğ—»ğ—²ğ˜ğ—²ğ˜€ ğ˜€ğ˜‚ğ—½ğ—½ğ—¼ğ—¿ğ˜ğ˜€ ğ—¼ğ—»ğ—¹ğ˜† ğ˜ğ—µğ—² ğ—¹ğ—®ğ˜€ğ˜ ğŸ¯ ğ˜ƒğ—²ğ—¿ğ˜€ğ—¶ğ—¼ğ—»ğ˜€.

Recently, I upgraded an ğ—˜ğ—ğ—¦ ğ—°ğ—¹ğ˜‚ğ˜€ğ˜ğ—²ğ—¿ ğ˜ğ—¼ ğ˜ƒğŸ­.ğŸ¯ğŸ®.ğŸ® and hereâ€™s how we achieved a ğ˜‡ğ—²ğ—¿ğ—¼-ğ—±ğ—¼ğ˜„ğ—»ğ˜ğ—¶ğ—ºğ—² ğ˜‚ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—² â¬‡ï¸

âš™ï¸ ğ—£ğ—¿ğ—²ğ—¿ğ—²ğ—¾ğ˜‚ğ—¶ğ˜€ğ—¶ğ˜ğ—²ğ˜€
ğŸ”¹ ğ—–ğ—µğ—²ğ—°ğ—¸ ğ—¿ğ—²ğ—¹ğ—²ğ—®ğ˜€ğ—² ğ—»ğ—¼ğ˜ğ—²ğ˜€ for version changes
ğŸ”¹ ğ—–ğ—µğ—²ğ—°ğ—¸ ğ—³ğ—¼ğ—¿ ğ—±ğ—²ğ—½ğ—¿ğ—²ğ—°ğ—®ğ˜ğ—²ğ—± ğ—”ğ—£ğ—œğ˜€ â†’ adjust manifests if needed
ğŸ”¹ Align add-ons and dependencies


ğŸ› ï¸ ğ—¨ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—² ğ—£ğ—¿ğ—¼ğ—°ğ—²ğ˜€ğ˜€

1ï¸âƒ£ ğ—–ğ—¼ğ—»ğ˜ğ—¿ğ—¼ğ—¹ ğ—£ğ—¹ğ—®ğ—»ğ—² ğ—¨ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—²
EKS â†’ Select cluster â†’ Click Upgrade version â†’ AWS manages it (~30 mins)

Upgrading the EKS control plane only updates the Kubernetes master components.

2ï¸âƒ£ ğ—¡ğ—¼ğ—±ğ—² ğ—šğ—¿ğ—¼ğ˜‚ğ—½ / ğ—¡ğ—¼ğ—±ğ—² ğ—¨ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—²

EKS â†’ Clusters â†’ Select Cluster â†’ Compute â†’ Node Groups â†’ Select Node Group â†’ Update â†’ Choose AMI / Kubernetes Version â†’ Apply

Monitor pod rescheduling & health

3ï¸âƒ£ ğ—”ğ—±ğ—±-ğ—¼ğ—»ğ˜€ ğ—¨ğ—½ğ—´ğ—¿ğ—®ğ—±ğ—²
Update CNI, CoreDNS, KubeProxy, and any custom add-ons to match the new version

âœ… Once validated â†’ Delete old node group

ğŸ” ğ—ğ—²ğ˜† ğ—Ÿğ—²ğ—®ğ—¿ğ—»ğ—¶ğ—»ğ—´
After the upgrade, we noticed an ğ—¶ğ—»ğ—°ğ—¿ğ—²ğ—®ğ˜€ğ—² ğ—¶ğ—» ğ—½ğ—¼ğ—± ğ—ºğ—²ğ—ºğ—¼ğ—¿ğ˜† ğ˜‚ğ˜€ğ—®ğ—´ğ—² ğŸ“ˆ due to cgroup v1 â†’ v2 switch in the latest AMI.
Itâ€™s not a bug âš ï¸ â€” just a ğ—»ğ—²ğ˜„ ğ—¿ğ—²ğ˜€ğ—¼ğ˜‚ğ—¿ğ—°ğ—² ğ—®ğ—°ğ—°ğ—¼ğ˜‚ğ—»ğ˜ğ—¶ğ—»ğ—´ ğ—ºğ—²ğ˜ğ—µğ—¼ğ—±. Keep this in mind while tuning requests/limits.


âš¡ ğ—£ğ—¿ğ—¼ ğ—§ğ—¶ğ—½: Always check release notes!
